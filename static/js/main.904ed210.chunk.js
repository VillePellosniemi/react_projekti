(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{164:function(e,t,a){},5451:function(e,t,a){e.exports=a(5641)},5456:function(e,t,a){},5590:function(e,t,a){},5608:function(e,t,a){},5609:function(e,t,a){},5611:function(e,t,a){},5628:function(e,t,a){},5629:function(e,t,a){},5637:function(e,t,a){},5638:function(e,t,a){},5639:function(e,t,a){},5640:function(e,t,a){},5641:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(26),l=a.n(i),o=(a(5456),a(23)),s=a(12),c=a(13),u=a(15),m=a(14),d=a(16),h=a(22),f=a(44),p="http://media.mw.metropolia.fi/wbma/",g=function(e){if(!e.ok)throw Error(e.statusText);return e},b=function(){return fetch(p+"media/").then(function(e){return e.json()}).then(function(e){return console.log(e),Promise.all(e.map(function(e){return fetch(p+"media/"+e.file_id).then(function(e){return e.json()})})).then(function(e){return console.log(e),e})})},E=function(e){return fetch(p+"media/user/"+e).then(function(e){return e.json()}).then(function(e){return console.log(e),Promise.all(e.map(function(e){return fetch(p+"media/"+e.file_id).then(function(e){return e.json()})})).then(function(e){return console.log(e),e})})},v=function(e){return fetch(p+"media/"+e).then(function(e){return e.json()})},y=function(e,t){var a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})};return fetch(p+"login",a).then(function(e){return e.json()})},w=function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch(p+"users",t).then(function(e){return e.json()})},j=function(e){return fetch(p+"users/username/"+e).then(function(e){return e.json()})},k=function(e){return fetch(p+"tags/"+e).then(function(e){return e.json()})},O=function(e,t){return fetch(p+"media",{method:"POST",body:e,headers:{"x-access-token":t}}).then(function(e){return e.json()})},S=function(e,t,a){var n={method:"PUT",body:JSON.stringify(t),headers:{"Content-type":"application/json","x-access-token":a}};return fetch(p+"media/"+e,n).then(g).then(function(e){return e.json()})},C=function(e,t){return fetch(p+"media/"+e,{method:"DELETE",headers:{"x-access-token":t}}).then(g).then(function(e){return e.json()})},F=function(e,t){var a=new RegExp("\\[f\\](.*?)\\[\\/f\\]");try{return JSON.parse(a.exec(e)[1])}catch(n){return t}},M=function(e){var t=new RegExp("\\[d\\]((.|[\\r\\n])*?)\\[\\/d\\]");console.log(t.exec(e));try{return t.exec(e)[1]}catch(a){return e}},x=a(9),N=a(20),L="http://media.mw.metropolia.fi/wbma/uploads/",I=function(e){var t=F(e.description,{brightness:100,contrast:100,warmth:0,saturation:100}),a=t.brightness,n=t.contrast,r=t.saturation,i=t.warmth;return{filter:"brightness(".concat(a,"%) contrast(").concat(n,"%) sepia(").concat(i,"%) saturate(").concat(r,"%)")}},U=function(e){return r.a.createElement("div",{id:"kuvat"},r.a.createElement(x.g,{cols:4},e.picArray.map(function(t){return r.a.createElement(x.h,{key:t.file_id},"image"===t.media_type&&r.a.createElement("img",{src:L+t.thumbnails.w160,alt:t.title,style:I(t)}),"video"===t.media_type&&r.a.createElement("img",{src:L+t.screenshot,alt:t.title}),"audio"===t.media_type&&r.a.createElement("img",{src:"http://placekitten.com/400/400",alt:t.title}),r.a.createElement(x.i,{title:t.title,actionIcon:r.a.createElement(r.a.Fragment,null,r.a.createElement(x.j,{component:h.b,to:"single/"+t.file_id},r.a.createElement(N.g,{style:{color:"white"}})),e.edit&&r.a.createElement(r.a.Fragment,null,r.a.createElement(x.j,{component:h.b,to:"modify/"+t.file_id},r.a.createElement(N.j,{style:{color:"white"}})),r.a.createElement(x.j,{onClick:function(){e.deleteFile(t.file_id)}},r.a.createElement(N.b,{style:{color:"white"}}))))}))})))},D=a(28),T=a(25),A=(a(164),a(62)),q=(a(5590),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).mediaUrl="http://media.mw.metropolia.fi/wbma/uploads/",a.state=a.props.state,a.rangeReducer=function(e,t){console.log(e);var n=t.name,r=Math.round(e);a.setState(function(e){return{filters:Object(o.a)({},e.filters,Object(D.a)({},n,r))}},function(){a.props.updateFilters(a.state.filters)})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="";return void 0===this.state.imageData||null===this.state.imageData?(console.log("if",this.state.imageData),e=this.mediaUrl+this.state.file.filename):(console.log("else"),e=this.state.imageData),r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:e,alt:"preview",className:"image",style:{filter:"brightness(".concat(this.state.filters.brightness,"%) contrast(").concat(this.state.filters.contrast,"%) sepia(").concat(this.state.filters.warmth,"%) saturate(").concat(this.state.filters.saturation,"%)")}}),r.a.createElement("div",null,r.a.createElement(x.l,{id:"brightness-label"},"Brightness: ",this.state.filters.brightness,"%"),r.a.createElement(A.a,{name:"brightness",value:this.state.filters.brightness,valueReducer:this.rangeReducer,min:0,max:200,step:1,"aria-labelledby":"brightness-label"})),r.a.createElement("div",null,r.a.createElement(x.l,{id:"contrast-label"},"Contrast: ",this.state.filters.contrast,"%"),r.a.createElement(A.a,{name:"contrast",value:this.state.filters.contrast,valueReducer:this.rangeReducer,min:0,max:200,step:1,"aria-labelledby":"contrast-label"})),r.a.createElement("div",null,r.a.createElement(x.l,{id:"saturation-label"},"Saturation: ",this.state.filters.saturation,"%"),r.a.createElement(A.a,{name:"saturation",value:this.state.filters.saturation,valueReducer:this.rangeReducer,min:0,max:200,step:1,"aria-labelledby":"saturation-label"})),r.a.createElement("div",null,r.a.createElement(x.l,{id:"warmth-label"},"Warmth: ",this.state.filters.warmth,"%"),r.a.createElement(A.a,{name:"warmth",value:this.state.filters.warmth,valueReducer:this.rangeReducer,min:0,max:100,step:1,"aria-labelledby":"warmth-label"})))}}]),t}(n.Component)),R=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).mediaUrl="http://media.mw.metropolia.fi/wbma/",a.fr=new FileReader,a.state={file:{title:"",description:"",filedata:null,filename:void 0},loading:!1,imageData:null,filters:{brightness:100,contrast:100,warmth:0,saturation:100},type:""},a.handleFileChange=function(e){e.persist(),console.log(e.target.files[0]),a.fr.readAsDataURL(e.target.files[0]),a.setState(function(t){return Object(o.a)({},t,{type:e.target.files[0].type,file:Object(o.a)({},t.file,{filedata:e.target.files[0]})})})},a.handleInputChange=function(e){var t=e.target,n=t.value,r=t.name;console.log(n,r),a.setState(function(e){return{file:Object(o.a)({},e.file,Object(D.a)({},r,n))}})},a.handleFileSubmit=function(e){console.log(e),a.setState({loading:!0});var t=new FormData;t.append("title",a.state.file.title);var n="[d]".concat(a.state.file.description,"[/d][f]").concat(JSON.stringify(a.state.filters),"[/f]");t.append("description",n),t.append("file",a.state.file.filedata),O(t,localStorage.getItem("token")).then(function(e){console.log(e),setTimeout(function(){a.props.history.push("/home"),a.props.updateImages(),a.setState({loading:!1})},2e3)})},a.updateFilters=function(e){a.setState(function(t){return{filters:e}})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.fr.addEventListener("load",function(){e.setState(function(t){return Object(o.a)({},t,{imageData:e.fr.result})})})}},{key:"render",value:function(){return r.a.createElement("div",{id:"upload"},r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{id:"up"},"Upload a File"),r.a.createElement("form",{id:"uploaddiv"},r.a.createElement(T.ValidatorForm,{instantValidate:!1,onSubmit:this.handleFileSubmit,onError:function(e){return console.log(e)}},r.a.createElement(T.TextValidator,{style:{marginTop:-5},name:"title",label:"Title",id:"title",value:this.state.file.title,onChange:this.handleInputChange,validators:["required","minStringLength:3"],errorMessages:["this field is required","minimum 3 charaters"],fullWidth:!0}),r.a.createElement(T.TextValidator,{style:{marginTop:5,marginBottom:5},name:"description",label:"Description",id:"description",value:this.state.file.description,onChange:this.handleInputChange,validators:["required","minStringLength:3"],errorMessages:["this field is required","minimum 3 charaters"],fullWidth:!0,multiline:!0}),r.a.createElement("input",{name:"filedata",id:"file",value:this.state.file.filename,type:"file",onChange:this.handleFileChange}),r.a.createElement("br",null),r.a.createElement(x.a,{id:"button1",type:"submit",variant:"contained",color:"primary"},"Upload\xa0\xa0",this.state.loading&&r.a.createElement(x.f,{size:20,color:"secondary"}))))),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"preview2"},null!==this.state.imageData&&this.state.type.includes("image")&&r.a.createElement(q,{state:this.state,updateFilters:this.updateFilters}))))}}]),t}(n.Component),_=a(35),P=a.n(_),V=a(81),W=(a(5608),a(77),a(5609),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.messages;return r.a.createElement("ul",{className:"Messages-list"},t.map(function(t){return e.renderMessage(t)}))}},{key:"renderMessage",value:function(e){var t=e.member,a=e.text,n=this.props.currentMember,i=t.id===n.id?"Messages-message currentMember":"Messages-message";return r.a.createElement("li",{className:i},r.a.createElement("span",{className:"avatar",style:{backgroundColor:t.clientData.color}}),r.a.createElement("div",{className:"Message-content"},r.a.createElement("div",{className:"username"},t.clientData.username),r.a.createElement("div",{className:"text"},a)))}}]),t}(n.Component)),B=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={text:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onChange",value:function(e){this.setState({text:e.target.value})}},{key:"onSubmit",value:function(e){e.preventDefault(),this.setState({text:""}),this.props.onSendMessage(this.state.text)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"Input"},r.a.createElement("form",{onSubmit:function(t){return e.onSubmit(t)}},r.a.createElement("input",{id:"ChatInput",onChange:function(t){return e.onChange(t)},value:this.state.text,type:"text",placeholder:"Enter your message and press ENTER",autofocus:"true"}),r.a.createElement("button",{id:"ChatButton"},"Send")))}}]),t}(n.Component);function J(){var e=["autumn","hidden","bitter","misty","silent","empty","dry","dark","summer","icy","delicate","quiet","white","cool","spring","winter","patient","twilight","dawn","crimson","wispy","weathered","blue","billowing","broken","cold","damp","falling","frosty","green","long","late","lingering","bold","little","morning","muddy","old","red","rough","still","small","sparkling","throbbing","shy","wandering","withered","wild","black","young","holy","solitary","fragrant","aged","snowy","proud","floral","restless","divine","polished","ancient","purple","lively","nameless"],t=["waterfall","river","breeze","moon","rain","wind","sea","morning","snow","lake","sunset","pine","shadow","leaf","dawn","glitter","forest","hill","cloud","meadow","sun","glade","bird","brook","butterfly","bush","dew","dust","field","fire","flower","firefly","feather","grass","haze","mountain","night","pond","darkness","snowflake","silence","sound","sky","shape","surf","thunder","violet","water","wildflower","wave","water","resonance","sun","wood","dream","cherry","tree","fog","frost","voice","paper","frog","smoke","star"];return e[Math.floor(Math.random()*e.length)]+t[Math.floor(Math.random()*t.length)]}var H=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).state={messages:[],member:{username:J(),color:"#"+Math.floor(16777215*Math.random()).toString(16)}},e.onSendMessage=function(t){e.drone.publish({room:"observable-room",message:t})},e.drone=new window.Scaledrone("BmjljJkiutah79dn",{data:e.state.member}),e.drone.on("open",function(t){if(t)return console.error(t);var a=Object(o.a)({},e.state.member);a.id=e.drone.clientId,e.setState({member:a})}),e.drone.subscribe("observable-room").on("data",function(t,a){var n=e.state.messages;n.push({member:a,text:t}),e.setState({messages:n})}),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"ChatApp"},r.a.createElement("div",{className:"ChatAppHeader"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("h1",null,"Chatpot")),r.a.createElement(W,{messages:this.state.messages,currentMember:this.state.member}),r.a.createElement(B,{onSendMessage:this.onSendMessage}))}}]),t}(n.Component),z=function(e){var t=e.picArray;e.messages;return r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,{item:!0,sm:8},r.a.createElement(V.Scrollbars,{class:"scroll",style:{width:"100%",height:550,backgroundColor:"#12355b"}},r.a.createElement(U,{picArray:t}))),r.a.createElement(P.a,{item:!0,sm:4},r.a.createElement(H,null)),r.a.createElement("div",null,r.a.createElement(R,null)))},G=(a(5611),a(5612),a(5627),function(){return r.a.createElement("div",{className:"fb-share-button","data-href":"https://www.your-domain.com/your-page.html","data-layout":"button_count"})}),Y=a(61),K=(a(5628),function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).state={liked:!1},e.handleClick=e.handleClick.bind(Object(Y.a)(Object(Y.a)(e))),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleClick",value:function(){this.setState({liked:!this.state.liked})}},{key:"render",value:function(){var e=(this.state.liked,""),t=this.state.liked?"Unlike":"Liked";return r.a.createElement("div",{className:"customContainer"},r.a.createElement("button",{className:"btn btn-primary",onClick:this.handleClick},t),r.a.createElement("p",null,"you ",e," "))}}]),t}(r.a.Component)),$=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).mediaUrl="http://media.mw.metropolia.fi/wbma/uploads/",a.state={file:{filename:"",title:"",description:"[d][/d][f][/f]",media_type:"image/jpg",user_id:1},filters:{brightness:100,contrast:100,warmth:0,saturation:100}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;v(t).then(function(t){console.log("pic",t),console.log("filters",F(t.description,e.state.filters)),e.setState({file:t,filters:F(t.description,e.state.filters)},function(){console.log("state",e.state)})})}},{key:"render",value:function(){var e=this.state.file,t=e.title,a=e.description,n=e.filename,i=e.media_type,l=this.state.filters,o=l.brightness,s=l.contrast,c=l.saturation,u=l.warmth;return r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,{item:!0,sm:8},r.a.createElement(x.a,{id:"backButton",onClick:this.props.history.goBack},"Back to Home"),r.a.createElement("div",{className:"kuvacontainer"},console.log(i),r.a.createElement("h1",{id:"test"},"Title: ",t),r.a.createElement("p",{id:"test"},"Description: ",M(a)),i.includes("image")&&r.a.createElement("img",{id:"image",src:this.mediaUrl+n,alt:t,style:{filter:"brightness(".concat(o,"%) contrast(").concat(s,"%) sepia(").concat(u,"%) saturate(").concat(c,"%)")}}),i.includes("video")&&r.a.createElement("video",{id:"video",src:this.mediaUrl+n,controls:!0}),i.includes("audio")&&r.a.createElement("audio",{id:"audio",src:this.mediaUrl+n,controls:!0}))),r.a.createElement(P.a,{item:!0,sm:3},r.a.createElement("div",{id:"share"},r.a.createElement(G,null),r.a.createElement(K,null))))}}]),t}(n.Component),Q=a(27),X=a(79),Z=a.n(X),ee=a(80),te=a.n(ee),ae=a(59),ne=a.n(ae),re=a(31),ie=a.n(re),le=(a(5629),a(78)),oe=a.n(le),se=a(58),ce=a.n(se),ue=a(37),me=a.n(ue),de=a(38),he=a.n(de),fe=a(39),pe=a.n(fe),ge=a(170),be=a.n(ge),Ee=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={left:!1},a.toggleDrawer=function(e,t){return function(){a.setState(Object(D.a)({},e,t))}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=r.a.createElement("div",{className:e.list},r.a.createElement(ce.a,null,r.a.createElement(me.a,{style:{padding:20,marginTop:-10},button:!0,component:h.b,to:"/home"},r.a.createElement(he.a,null,r.a.createElement(N.e,null)),r.a.createElement(pe.a,{primary:"Home"})),this.props.checkLogin()&&r.a.createElement(r.a.Fragment,null,r.a.createElement(me.a,{style:{padding:20},button:!0,component:h.b,to:"/chat"},r.a.createElement(he.a,null,r.a.createElement(N.k,null)),r.a.createElement(pe.a,{primary:"Chat"})),r.a.createElement(me.a,{style:{padding:20},button:!0,component:h.b,to:"/profile"},r.a.createElement(he.a,null,r.a.createElement(N.h,null)),r.a.createElement(pe.a,{primary:"Profile"})),r.a.createElement(me.a,{style:{padding:20},button:!0,component:h.b,to:"/my-files"},r.a.createElement(he.a,null,r.a.createElement(N.c,null)),r.a.createElement(pe.a,{primary:"My Files"})),r.a.createElement(me.a,{style:{padding:20},button:!0,component:h.b,to:"/logout"},r.a.createElement(he.a,null,r.a.createElement(N.d,null)),r.a.createElement(pe.a,{primary:"Logout"}))),!this.props.checkLogin()&&r.a.createElement(me.a,{style:{padding:20},button:!0,component:h.b,to:"/"},r.a.createElement(he.a,null,r.a.createElement(N.d,null)),r.a.createElement(pe.a,{primary:"Login"}))));return r.a.createElement("div",{className:e.root},r.a.createElement(Z.a,{id:"appbar",position:"static"},r.a.createElement(te.a,null,r.a.createElement(oe.a,{id:"menu",onClick:this.toggleDrawer("left",!0),color:"inherit","aria-label":"Menu"},r.a.createElement(N.f,null)),r.a.createElement(be.a,{type:"temporary",classes:{paper:e.drawerPaper},open:this.state.left,onClose:this.toggleDrawer("left",!1)},r.a.createElement("div",{tabIndex:0,role:"button",onClick:this.toggleDrawer("left",!1),onKeyDown:this.toggleDrawer("left",!1)},t)),r.a.createElement("h1",{id:"header"},"Masentaa!"),r.a.createElement(ne.a,{variant:"h6",color:"inherit",className:e.grow}),r.a.createElement(ie.a,{color:"inherit",button:!0,component:h.b,to:"/home",className:"hidden"},r.a.createElement(N.e,null),"Home"),r.a.createElement(ie.a,{color:"inherit",button:!0,component:h.b,to:"/home",className:"hidden"},r.a.createElement(N.e,null),"Home"),r.a.createElement(ie.a,{style:{margin:10},color:"inherit",button:!0,component:h.b,to:"/home",className:"link"},r.a.createElement(N.e,null),"Home"),this.props.checkLogin()&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ie.a,{style:{margin:10},color:"inherit",button:!0,component:h.b,to:"/chat",className:"link"},r.a.createElement(N.a,null),"Chat"),r.a.createElement(ie.a,{style:{margin:10},color:"inherit",button:!0,component:h.b,to:"/profile",className:"link"},r.a.createElement(N.h,null),"Profile"),r.a.createElement(ie.a,{style:{margin:10},color:"inherit",button:!0,component:h.b,to:"/my-files",className:"link"},r.a.createElement(N.k,null),"Files"),r.a.createElement(ie.a,{style:{margin:10},color:"inherit",button:!0,component:h.b,to:"/logout",className:"link"},r.a.createElement(N.d,null),"Logout")),!this.props.checkLogin()&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ie.a,{style:{margin:10},color:"inherit",button:!0,component:h.b,to:"/",className:"link"},r.a.createElement(N.d,null),"Login")))))}}]),t}(r.a.Component),ve=Object(Q.withStyles)({root:{flexGrow:1},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20},drawerHeader:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},drawerPaper:{width:"35%"}})(Ee),ye=a(111),we=a.n(ye),je=(a(5637),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={user:{username:"",password:"",email:"",full_name:"",repeatPassword:""},message:"",formToggler:!0,validUser:!0},a.handleLoginSubmit=function(e){e.preventDefault(),a.doLogin()},a.handleRegisterSubmit=function(){var e=Object(o.a)({},a.state.user);delete e.repeatPassword,w(e).then(function(e){console.log(e),void 0===e.message?a.doLogin():a.setState({message:e.message})})},a.doLogin=function(){y(a.state.user.username,a.state.user.password).then(function(e){console.log(e),void 0!==e.user?(a.props.setUser(e.user),localStorage.setItem("token",e.token),a.props.history.push("/home")):a.setState({message:e.message})}).catch(function(e){console.log(e)})},a.handleInputChange=function(e){var t=e.target,n=t.value,r=t.name;console.log(n,r),a.setState(function(e){return{user:Object(o.a)({},e.user,Object(D.a)({},r,n))}}),"username"===r&&a.checkUsername(t.value)},a.checkUsername=function(e){j(e).then(function(e){console.log(e.available),a.setState({validUser:e.available})})},a.toggleForm=function(){a.setState({formToggler:!a.state.formToggler})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;console.log(localStorage.getItem("token")),null!==localStorage.getItem("token")&&(e=localStorage.getItem("token"),fetch(p+"users/user",{headers:{"x-access-token":e}}).then(function(e){return e.json()})).then(function(e){t.props.setUser(e),t.props.history.push("/home")}),T.ValidatorForm.addValidationRule("isPasswordMatch",function(e){return e===t.state.user.password}),T.ValidatorForm.addValidationRule("isUserAvailable",function(){return t.state.validUser})}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",{className:"container"},this.state.formToggler&&r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{id:"login",onSubmit:this.handleLoginSubmit},r.a.createElement("h1",{className:"header"},"Login"),r.a.createElement(x.k,{required:!0,fullWidth:!0,name:"username",id:"username",label:"Username",value:this.state.user.username,onChange:this.handleInputChange}),r.a.createElement("br",null),r.a.createElement(x.k,{required:!0,fullWidth:!0,name:"password",type:"password",id:"password",label:"Password",value:this.state.user.password,onChange:this.handleInputChange}),r.a.createElement("br",null),r.a.createElement(x.a,{id:"button",variant:"contained",type:"submit"},"Login",r.a.createElement(N.i,{style:{paddingLeft:6}})),r.a.createElement(x.a,{id:"button2",variant:"contained",onClick:this.toggleForm},"No account yet?",r.a.createElement("br",null),"Register here!"),r.a.createElement("p",{className:e.alert},this.state.message))),!this.state.formToggler&&r.a.createElement(r.a.Fragment,null,r.a.createElement(T.ValidatorForm,{id:"register",instantValidate:!1,onSubmit:this.handleRegisterSubmit,onError:function(e){return console.log(e)}},r.a.createElement("h1",{className:"header"},"Register"),r.a.createElement(T.TextValidator,{fullWidth:!0,required:!0,name:"username",id:"username",label:"Username",value:this.state.user.username,onChange:this.handleInputChange,validators:["required","minStringLength:3","isUserAvailable"],errorMessages:["this field is required","minimum 3 charaters","username not available"]}),r.a.createElement(T.TextValidator,{fullWidth:!0,required:!0,name:"password",type:"password",id:"password",label:"Password",value:this.state.user.password,onChange:this.handleInputChange,validators:["required","minStringLength:5"],errorMessages:["this field is required","minimum 5 characters"]}),r.a.createElement(T.TextValidator,{fullWidth:!0,required:!0,name:"repeatPassword",type:"password",id:"repeatPassword",label:"Repeat password",value:this.state.user.repeatPassword,onChange:this.handleInputChange,validators:["isPasswordMatch","required"],errorMessages:["password mismatch","this field is required"]}),r.a.createElement(T.TextValidator,{fullWidth:!0,required:!0,name:"email",id:"email",label:"Email",value:this.state.user.email,onChange:this.handleInputChange,validators:["required","isEmail"],errorMessages:["this field is required","email is not valid"]}),r.a.createElement(x.k,{fullWidth:!0,required:!0,name:"full_name",id:"full_name",label:"Full name",value:this.state.user.full_name,onChange:this.handleInputChange}),r.a.createElement(x.a,{id:"button",variant:"contained",type:"submit"},"Register",r.a.createElement(N.i,{style:{paddingLeft:6}})),r.a.createElement(x.a,{id:"button2",variant:"contained",onClick:this.toggleForm},"Already got an",r.a.createElement("br",null),"account? Log in!"),r.a.createElement("p",{className:e.alert},this.state.message))))}}]),t}(n.Component)),ke=Object(Q.withStyles)(function(e){return{container:{width:"50%",padding:"1rem"},button:{marginLeft:5},alert:{color:we.a[500]}}})(je),Oe=(a(5638),function(e){if(null===e.user)return r.a.createElement(f.a,{to:"/"});var t=e.user,a=t.username,n=t.email,i=t.full_name;return r.a.createElement("div",{id:"profilecontainer"},r.a.createElement(r.a.Fragment,null,r.a.createElement(x.b,{id:"card"},r.a.createElement("h1",{className:"profile"},"Your Profile"),r.a.createElement(x.c,null,r.a.createElement(x.e,{className:"media",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/1024px-Circle-icons-profile.svg.png",title:a}),r.a.createElement(x.d,null,r.a.createElement(x.l,{id:"profileuser",gutterBottom:!0,variant:"h5",component:"h2"},a),r.a.createElement(x.l,{id:"profilecontent",component:"p"},"Email: ",n),r.a.createElement(x.l,{id:"profilecontent",component:"p"},"Full name: ",i))))))}),Se=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){localStorage.removeItem("token"),this.props.setUserLogout(null),this.props.history.push("/")}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Logout"))}}]),t}(n.Component),Ce=a(60),Fe=a.n(Ce),Me=(a(5639),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={picArray:[]},a.updateUserImages=function(){E(a.props.user.user_id).then(function(e){console.log(e),a.setState({picArray:e})})},a.deleteFile=function(e){console.log("delete",e),window.confirm("Delete File?")&&C(e,localStorage.getItem("token")).then(function(e){a.updateUserImages()}).catch(function(e){console.log(e)})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.user?this.updateUserImages():this.props.history.push("/")}},{key:"render",value:function(){return r.a.createElement("div",{id:"myfiles-div"},r.a.createElement("div",{id:"myfiles-content"},r.a.createElement("h1",{id:"myfiles-header"},"Your Uploaded Files"),r.a.createElement(V.Scrollbars,{class:"scroll",style:{height:500,width:"100%"}},r.a.createElement(U,{picArray:this.state.picArray,edit:!0,deleteFile:this.deleteFile}))))}}]),t}(n.Component)),xe=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).mediaUrl="http://media.mw.metropolia.fi/wbma/",a.state={file:{title:"",description:"",filedata:null,filename:void 0,file_id:0},loading:!1,imageData:null,filters:{brightness:100,contrast:100,warmth:0,saturation:100},type:""},a.handleFileChange=function(e){e.persist(),console.log(e.target.files[0]),a.fr.readAsDataURL(e.target.files[0]),a.setState(function(t){return Object(o.a)({},t,{type:e.target.files[0].type,file:Object(o.a)({},t.file,{filedata:e.target.files[0]})})})},a.handleInputChange=function(e){var t=e.target,n=t.value,r=t.name;console.log(n,r),a.setState(function(e){return{file:Object(o.a)({},e.file,Object(D.a)({},r,n))}})},a.handleFileSubmit=function(e){console.log(e),a.setState({loading:!0});var t={title:a.state.file.title,description:"[d]".concat(M(a.state.file.description),"[/d][f]").concat(JSON.stringify(a.state.filters),"[/f]")};S(a.state.file.file_id,t,localStorage.getItem("token")).then(function(e){console.log(e),setTimeout(function(){a.setState({loading:!1}),a.props.history.push("/my-files")},2e3)}).catch(function(e){console.log("error",e)})},a.updateFilters=function(e){a.setState(function(t){return{filters:e}})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;v(t).then(function(t){console.log("pic",t),console.log("filters",F(t.description,e.state.filters)),e.setState({file:t,filters:F(t.description,e.state.filters)},function(){console.log("state",e.state)})})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Modify"),r.a.createElement(T.ValidatorForm,{instantValidate:!1,onSubmit:this.handleFileSubmit,onError:function(e){return console.log(e)}},r.a.createElement(T.TextValidator,{name:"title",label:"Title",value:this.state.file.title,onChange:this.handleInputChange,validators:["required","minStringLength:3"],errorMessages:["this field is required","minimum 3 charaters"],fullWidth:!0}),r.a.createElement(T.TextValidator,{name:"description",label:"Description",value:M(this.state.file.description),onChange:this.handleInputChange,validators:["required","minStringLength:3"],errorMessages:["this field is required","minimum 3 charaters"],fullWidth:!0,multiline:!0,rows:3}),r.a.createElement(x.a,{type:"submit",variant:"contained",color:"primary"},"Save\xa0\xa0",this.state.loading&&r.a.createElement(x.f,{size:20,color:"secondary"}))),void 0!==this.state.file.filename&&r.a.createElement(q,{state:this.state,updateFilters:this.updateFilters}))}}]),t}(n.Component),Ne=(a(5640),{height:"665px"}),Le=function(){return r.a.createElement(r.a.Fragment,{id:"chat-kokosivu"},r.a.createElement(P.a,{item:!0,xs:4,md:12},r.a.createElement("div",{style:Ne},r.a.createElement(H,null))))};function Ie(){var e=["autumn","hidden","bitter","misty","silent","empty","dry","dark","summer","icy","delicate","quiet","white","cool","spring","winter","patient","twilight","dawn","crimson","wispy","weathered","blue","billowing","broken","cold","damp","falling","frosty","green","long","late","lingering","bold","little","morning","muddy","old","red","rough","still","small","sparkling","throbbing","shy","wandering","withered","wild","black","young","holy","solitary","fragrant","aged","snowy","proud","floral","restless","divine","polished","ancient","purple","lively","nameless"],t=["waterfall","river","breeze","moon","rain","wind","sea","morning","snow","lake","sunset","pine","shadow","leaf","dawn","glitter","forest","hill","cloud","meadow","sun","glade","bird","brook","butterfly","bush","dew","dust","field","fire","flower","firefly","feather","grass","haze","mountain","night","pond","darkness","snowflake","silence","sound","sky","shape","surf","thunder","violet","water","wildflower","wave","water","resonance","sun","wood","dream","cherry","tree","fog","frost","voice","paper","frog","smoke","star"];return e[Math.floor(Math.random()*e.length)]+t[Math.floor(Math.random()*t.length)]}var Ue=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).state={messages:[],member:{username:Ie(),color:"#"+Math.floor(16777215*Math.random()).toString(16)},picArray:[],user:null},e.onSendMessage=function(t){e.drone.publish({room:"observable-room",message:t})},e.setUser=function(t){k("profile").then(function(t){var a=t.filter(function(t){var a=null;return t.user_id===e.state.user.user_id&&(a=t),a});e.setState(function(e){return{user:Object(o.a)({},e.user,{profilePic:a[0]})}})}),e.setState({user:t})},e.setUserLogout=function(t){e.setState({user:t})},e.checkLogin=function(){return null!==e.state.user},e.updateImages=function(){b().then(function(t){console.log(t),e.setState({picArray:t})})},e.drone=new window.Scaledrone("BmjljJkiutah79dn",{data:e.state.member}),e.drone.on("open",function(t){if(t)return console.error(t);var a=Object(o.a)({},e.state.member);a.id=e.drone.clientId,e.setState({member:a})}),e.drone.subscribe("observable-room").on("data",function(t,a){var n=e.state.messages;n.push({member:a,text:t}),e.setState({messages:n})}),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.updateImages()}},{key:"render",value:function(){var e=this;return r.a.createElement(h.a,{basename:"/~villeope/my-app"},r.a.createElement(Fe.a,{container:!0},r.a.createElement(Fe.a,{item:!0,sm:12},r.a.createElement(ve,{checkLogin:this.checkLogin})),r.a.createElement(f.b,{path:"/home",render:function(t){return r.a.createElement(z,Object.assign({},t,{messages:e.state.messages,currentMember:e.state.member,picArray:e.state.picArray}))}}),r.a.createElement(f.b,{path:"/upload",render:function(t){return r.a.createElement(R,Object.assign({},t,{updateImages:e.updateImages}))}}),r.a.createElement(f.b,{path:"/videos",render:function(t){return r.a.createElement(Oe,Object.assign({},t,{user:e.state.videos}))}}),r.a.createElement(f.b,{path:"/single/:id",component:$}),r.a.createElement(f.b,{path:"/chat",component:Le}),r.a.createElement(f.b,{path:"/modify/:id",component:xe}),r.a.createElement(f.b,{path:"/profile",render:function(t){return r.a.createElement(Oe,Object.assign({},t,{user:e.state.user}))}}),r.a.createElement(f.b,{path:"/my-files",render:function(t){return r.a.createElement(Me,Object.assign({},t,{user:e.state.user}))}}),r.a.createElement(f.b,{exact:!0,path:"/",render:function(t){return r.a.createElement(ke,Object.assign({},t,{setUser:e.setUser}))}}),r.a.createElement(f.b,{path:"/logout",render:function(t){return r.a.createElement(Se,Object.assign({},t,{setUserLogout:e.setUserLogout}))}})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(Ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},77:function(e,t,a){}},[[5451,1,2]]]);
//# sourceMappingURL=main.904ed210.chunk.js.map